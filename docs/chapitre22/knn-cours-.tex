% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames*,x11names*}{xcolor}
%
\documentclass[
  11pt,
]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{
\usepackage{hyperref}
}
\hypersetup{
  pdftitle={Cours sur l'algorithme des k plus proches voisins},
  pdfauthor={Première NSI, Lycée du Parc},
  colorlinks=true,
  linkcolor=Maroon,
  filecolor=Maroon,
  citecolor=Blue,
  urlcolor=Blue,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[top=20mm,left=20mm,right=20mm,heightrounded]{geometry}
\usepackage{listings}
\newcommand{\passthrough}[1]{#1}
\lstset{defaultdialect=[5.3]Lua}
\lstset{defaultdialect=[x86masm]Assembler}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}

\title{Cours sur l'algorithme des k plus proches voisins}
\usepackage{etoolbox}
\makeatletter
\providecommand{\subtitle}[1]{% add subtitle to \maketitle
  \apptocmd{\@title}{\par {\large #1 \par}}{}{}
}
\makeatother
\subtitle{Thème algorithmique}
\author{Première NSI, \href{https://frederic-junier.org/}{Lycée du Parc}}
\date{}

%%%jolis boites

\usepackage{fancybox, graphicx}



%%%%%%%%%%%%%%%%Packages et Macros Frederic%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%Insertion de liens hypertextes %%%%

            
%%%%%%%%%%PSTricks%%%%%%%%%%%%

\usepackage{pstricks,pst-plot,pst-text,pst-tree,pst-eps,pst-fill,pst-node,pst-math,pstricks-add,pst-xkey,pst-eucl}


%%%%%%%Tikz%%%%%%%%%%%%%%%
\usepackage{pgf,tikz,tkz-tab}
% Pour les tableaux de signes ou de variations avec tkz-tab voir https://zestedesavoir.com/tutoriels/439/des-tableaux-de-variations-et-de-signes-avec-latex/#1-13389_tikz-un-package-qui-en-a-dans-le-ventre
\usetikzlibrary{arrows}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{petri}
\usetikzlibrary{decorations}
\usetikzlibrary{arrows}
\usetikzlibrary{math}
 %Variables must be declared in a tikzmath environment but
       % can be used outside
%       \tikzmath{int \n; \n = 508; \x1 = 1; \y1 =1; 
%                   %computations are also possible
%                    \x2 = \x1 + 1; \y2 =\y1 +3; } 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%Commandes Tikz Perso%%%%%%%%%%%%%%%

% Définition des nouvelles options xmin, xmax, ymin, ymax
% Valeurs par défaut : -3, 3, -3, 3
\tikzset{
xmin/.store in=\xmin, xmin/.default=-3, xmin=-3,
xmax/.store in=\xmax, xmax/.default=3, xmax=3,
ymin/.store in=\ymin, ymin/.default=-3, ymin=-3,
ymax/.store in=\ymax, ymax/.default=3, ymax=3,
}
% Commande qui trace la grille entre (xmin,ymin) et (xmax,ymax)
\newcommand {\grille}[2]
{\draw[help lines,black, thick] (\xmin,\ymin) grid[xstep=#1, ystep=#2] (\xmax,\ymax);}
% Commande \axes
\newcommand {\axes} {
\draw[->,very thick] (\xmin,0) -- (\xmax,0);
\draw[->,very thick] (0,\ymin) -- (0,\ymax);
\draw (0.95*\xmax, 0) node[above] {};
\draw (0, 0.95*\ymax) node[left] {};
}
% Commande qui limite l?affichage à (xmin,ymin) et (xmax,ymax)
\newcommand {\fenetre}
{\clip (\xmin,\ymin) rectangle (\xmax,\ymax);}

%Exemple d'utilisation

%\begin{center}
%\begin{tikzpicture} [xmin=-2,xmax=2,ymin=0,ymax=5]
%\grille{1} \axes \fenetre
%\draw plot[smooth] (\x,\x^2);
%\end{tikzpicture}
%\end{center}

%style pour la perspective cavalière française
%voir Tikz pour l'impatient page 68
\tikzset{math3d/.style=
{x= {(-0.353cm,-0.353cm)}, z={(0cm,1cm)},y={(1cm,0cm)}}}

%%%%%%%Symbole pour code calculatrice%%%%%%

%Flèche remplie pour défilement de menu

\newcommand{\flechefillright}{
\begin{tikzpicture}[scale=0.15] \fill (0,0)--(2,1)--(0,2)--cycle;
\end{tikzpicture}}

%%%%%%%%%%%%%Symboles pour calculatrice Casio%%%%
\newcommand{\execasio}{\Pisymbol{psy}{191}} %Retour chariot
\newcommand{\dispcasio}{\begin{pspicture}(.1,.1)\pspolygon*(.1,0)(.1,.1)\end{pspicture}} %Triangle Â« Disp Â»
\newcommand{\dispcasiotikz}{\begin{tikzpicture}[scale=0.2]
\fill (0,0) -- (1,0) -- (1,1) -- cycle;
\end{tikzpicture}} %Triangle Â« Disp Â»
%

%Fleche entre deux lignes, d'apres 'un bon petit' : http://forum.mathematex.net/latex-f6/fleches-entre-deux-lignes-pour-resolution-d-equation-t10283.html#p99817
\newcommand\addnode[1]{\Rnode{#1}{}}
\newcommand\linknode[3]{\ncbar[angleA=0,angleB=0,nodesep=1ex,arm=10ex,offset=-2pt]{->}{#1}{#2}\Aput{\vphantom{x}#3}}


%%Commande pour touche de calculatrice

\newcommand\tc[1]{%
{
\begin{tikzpicture}
\node[draw,rectangle,rounded corners=3pt] (P) at (0,0){#1};
\end{tikzpicture}
}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%Fin Commandes Tikz%%%%%%%%%%%%%%%


%%%%%%%%%%%%Specifiques%%%%%%%%%%%
\usepackage{wrapfig}
%pour insérer une figure à droite ou à gauche d'un texte
%\begin{wrapfigure}[nb lignes]{placement l,r,c,i(inside),o(outside)}[overhang]{width}
%ce package fonctionne mal à proximité des listes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%Environnements et symboles spéciaux pour faire joli%%%%%%

%%%Bclogo, pour des environnements + jolis avec insertion de logo%%%%
%Dépendances de  bclogo
\usepackage{xkeyval}  
\usepackage{etoolbox}
\usepackage{ifpdf}
\usepackage[framemethod=tikz]{mdframed}
\usepackage[tikz]{bclogo}

%\newcommand\bcpython{\includegraphics[width=17pt]{/home/fjunier/Maths/python-logo.eps}}
\newcommand\bcpython{\includegraphics[width=17pt]{/home/fjunier/Maths/python-logo.png}}
%\newcommand\bcpython{\includegraphics[width=17pt]{/home/frederic/Maths/python-logo.png}}

%% Framed
\usepackage{framed}  %Le package « framed» Crée 3 nouveaux environnements, qui se comportent comme des minipage de largeur \linewidth, mais permettant en plus de se casser entre plusieurs pages.     * framed : avec un cadre autour;     * shaded : avec un fonc coloré (il faut définir la couleur shadecolor);     * leftbar : avec une barre le long du côté gauche.

%%%%%%%%%%%%%%%%%%%Présentation de codes sources%%%%%%%%%%%%%%%%%
\usepackage{listings}
%On utilise l?environnement lstlisting pour insérer
%un code source.
%En plus de l?environnement lstlisting, on peut également utiliser la
%commande \lstinline qui fonctionne comme la commande \verb, en ce
%sens qu?on peut utiliser n?importe quel caractère comme délimiteur. Enfin,
%la commande \lstinputlisting permet de charger un code source depuis
%un fichier externe.
%Il y a deux manières de préciser des options : soit via l?option de l?envi-
%ronnement ou de la commande, soit en utilisant la commande \lstset
%qui permet de définir des options de manière globale.

\lstset{ %
  language=Python,                % the language of the code
  basicstyle=\ttfamily,           % the size of the fonts that are used for the code
  %numbers=left,                   % where to put the line-numbers
  numberstyle=\tiny,  % the style that is used for the line-numbers
  %stepnumber=2,                   % the step between two line-numbers. If it's 1, each line 
                                  % will be numbered
  %numbersep=5pt,                  % how far the line-numbers are from the code
  backgroundcolor=\color{white},      % choose the background color. You must add \usepackage{color}
  showspaces=false,               % show spaces adding particular underscores
  showstringspaces=false,         % underline spaces within strings
  showtabs=false,                 % show tabs within strings adding particular underscores
  frame=single,                   % adds a frame around the code
  rulecolor=\color{black},        % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  tabsize=4,                      % sets default tabsize to 2 spaces
  captionpos=b,                   % sets the caption-position to bottom
  breaklines=true,                % sets automatic line breaking
  breakatwhitespace=false,        % sets if automatic breaks should only happen at whitespace
  %title=\lstname,                   % show the filename of files included with \lstinputlisting;
                                  % also try caption instead of title
  breakindent=1cm,
  keywordstyle=\color{blue},          % keyword style
  commentstyle=\color{red},       % comment style
  %stringstyle=\ttfamily\color{green},         % string literal style
  escapeinside={\%*}{*)},            % if you want to add LaTeX within your code
  morekeywords={*,...},              % if you want to add more keywords to the set
  deletekeywords={...}              % if you want to delete keywords from the given language
  upquote=true,columns=flexible,
xleftmargin=1cm,xrightmargin=1cm,
 inputencoding=utf8,			%Les lignes qui suivent sont pour le codage utf8
  extendedchars=true,
  literate=%
            {é}{{\'{e}}}1
            {è}{{\`{e}}}1
            {ê}{{\^{e}}}1
            {ë}{{\¨{e}}}1
            {û}{{\^{u}}}1
            {ù}{{\`{u}}}1
            {â}{{\^{a}}}1
            {à}{{\`{a} }}1
            {î}{{\^{i}}}1
            {ô}{{\^{o}}}1
            {ç}{{\c{c}}}1
            {Ç}{{\c{C}}}1
            {É}{{\'{E}}}1
            {Ê}{{\^{E}}}1
            {À}{{\`{A}}}1
            {Â}{{\^{A}}}1
            {Î}{{\^{I}}}1
}

\lstdefinestyle{rond}{
  numbers=none,
  backgroundcolor=\color{gristclair},
  frameround =tttt
}

\lstdefinestyle{compil}{
  numbers=none,
  backgroundcolor=\color{gristclair}
}
%\lstset{language=Python,basicstyle=\small , frame=single,tabsize=4,showspaces=false,showtabs=false,showstringspaces=false,numbers=left,numberstyle=\tiny , extendedchars=true}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%Environnements persos%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Syntaxe :
%\newenvironment{nom}[nombre d'args][defaut]{definitions initiales}{definitions finales}
%definitions intiales sont les commandes appelées par \begin{nom}
%Definitions finales sont les commandes appelées par \end{nom}

%%%%%%%%%%%%%%%%Définitions des environnemts persostheoreme, exemple ..%%%%
%%%% Exercice avec encadré %%%%
\newcounter{exo}
\newenvironment{exercice}[1]
{\par \medskip   \addtocounter{exo}{1} \noindent  
\begin{bclogo}[arrondi =0.1,   noborder = true, logo=\bccrayon, marge=4]{~\textbf{Exercice} \textbf{\theexo} {\itshape #1} }  \par}
{
\end{bclogo}
 \par \bigskip }

%%Axiomes, Theoremes, Propriété, Définition, Methode, Preuve


\newenvironment{axiome}[1]
{\par \medskip   \begin{leftbar} \noindent \underline{\textbf{Axiome}}\hspace{0.5cm}{\itshape #1}   \vspace*{10pt} \par }
{\end{leftbar}  \par \medskip }


\newcounter{thme}
\newenvironment{theoreme}[1]
{\par \medskip  \addtocounter{thme}{1} \noindent  
\begin{bclogo}[arrondi =0.1,  ombre = true, barre=none, logo=\bcbook, marge=4]{~\textbf{Théorème} \textbf{\thethme} {\itshape #1} }   \par}
{
\end{bclogo}
 \par \bigskip}

 \newenvironment{theoremedef}[1]
{\par \medskip   \addtocounter{thme}{1} \noindent  
\begin{bclogo}[arrondi =0.1,  ombre = true, barre=none, logo=\bcbook, marge=4]{~\textbf{Théorème-Définition} \textbf{\thethme} {\itshape #1} }   \par}
{
\end{bclogo}
 \par \bigskip }
 
\newcounter{prop}
\newenvironment{propriete}[1]
{\par \medskip   \addtocounter{prop}{1} \noindent  
\begin{bclogo}[arrondi =0.1,  ombre = true, barre=none, logo=\bcbook, marge=4]{~\textbf{Propriété} \textbf{\theprop} {\itshape #1} }   \par}
{
\end{bclogo}
 \par \bigskip }


\newenvironment{corollaire}[1]
{\par \medskip   \noindent  
\begin{bclogo}[arrondi =0.1,  ombre = true, barre=none, logo=\bcbook, marge=4]{~\textbf{Corollaire} {\itshape #1} } \par }
{
\end{bclogo}
 \par \bigskip }

\newenvironment{demo}[1]
{\par \medskip   \noindent  
\begin{bclogo}[arrondi =0.1,  ombre = true, barre=zigzag, noborder = true, logo=\bcloupe, marge=0]{~\textbf{Démonstration} {\itshape #1} } \par \vspace{10pt}}
{
\end{bclogo}
 \par \bigskip }

\newcounter{activite}
\newenvironment{activite}[1]
{\par \medskip   \noindent   \addtocounter{activite}{1}
\begin{bclogo}[arrondi =0.1,   noborder = true, logo=\bcvelo, marge=4]{~\textbf{Activité} \textbf{\theactivite} {\itshape #1} }  \par}
{
\end{bclogo}
 \par \bigskip }


\newenvironment{synthese}
{\par \medskip   \noindent   
\begin{bclogo}[arrondi =0.1,   noborder = true, logo=\bccle, marge=4]{~\textbf{Synthèse}   }  \par}
{
\end{bclogo}
 \par \bigskip }
 
 
\newcounter{rque}
\newenvironment{remarque}
{\par \medskip    \addtocounter{rque}{1} \noindent  
\begin{bclogo}[arrondi =0.1,  ombre = true, barre=snake, noborder = true, logo=\bcinfo, marge=0]{~\textbf{Remarque} \textbf{\therque}}  \par }
{
\end{bclogo}
 \par \bigskip }

\newcounter{def}
\newenvironment{definition}[1]
{\par \medskip   \addtocounter{def}{1} \noindent  
\begin{bclogo}[arrondi =0.1,  ombre = true, barre=none, logo=\bcbook, marge=4]{~\textbf{Définition} \textbf{\thedef} {\itshape #1} }  \par}
{
\end{bclogo}
 \par \bigskip }
 
 
 \newcounter{cours}
\newenvironment{cours}[1]
{\par \medskip   \addtocounter{cours}{1} \noindent  
\begin{bclogo}[arrondi =0.1,  ombre = true, barre=none, logo=\bcbook, marge=4]{~\textbf{Point de cours} \textbf{\thecours} {\itshape #1} }  \par}
{
\end{bclogo}
 \par \bigskip }
 
 

\newenvironment{introduction}
{\par \medskip    \noindent  
 \begin {bclogo}[couleur = blue!5 , arrondi =0.1,logo=\bcrosevents, marge=4] {~\textbf{Introduction}    }
 \par }
{
\end{bclogo}
 \par \bigskip }
 
\newenvironment{memo}[1]
{\par \medskip    \noindent  
\begin{bclogo}[arrondi =0.1,  ombre = true, barre=none, logo=\bccle, marge=4]{~\textbf{À retenir}  {\itshape #1} }  \par}
{
\end{bclogo}
 \par \bigskip }
 
\newcounter{exple}
\newenvironment{exemple}[1]
{\par \medskip   \addtocounter{exple}{1} \noindent  
\begin{bclogo}[arrondi =0.1,   noborder = true, logo=\bclampe, marge=4]{~\textbf{Exemple} \textbf{\theexple} {\itshape #1} }  \par}
{
\end{bclogo}
 \par \bigskip }




\newcounter{alg}
\newenvironment{algorithme}[1]
{\par \medskip   \addtocounter{alg}{1} \noindent  
 \begin {bclogo}[noborder = true, barre=zigzag,logo=\bcpython, marge=4] {~\textbf{Algorithmique} \textbf{\thealg} {\itshape #1} }  \par}
{
\end{bclogo}
 \par \bigskip }

\newcounter{prog}
\newenvironment{programme}[1]
{\par \medskip   \addtocounter{prog}{1} \noindent  
 \begin {bclogo}[noborder = true, barre=zigzag,logo=\bcpython, marge=4] {~\textbf{Programme} \textbf{\theprog} {\itshape #1} }  \par  \bigskip}
{
\end{bclogo}
 \par \bigskip }
 
\newcounter{logi}
\newenvironment{logique}[1]
{\par \medskip   \addtocounter{logi}{1} \noindent  
 \begin {bclogo}[noborder = true, barre=zigzag,logo=\bclampe, marge=4] {~\textbf{Logique} \textbf{\thelogi} {\itshape #1} }  \par}
{
\end{bclogo}
 \par \bigskip }


\newenvironment{methode}[1]
{\par \medskip    \noindent  
 \begin {bclogo}[arrondi =0.1,logo=\bcoutil, marge=4,noborder = true] {~\textbf{Méthode}   {\itshape #1} }  \par}
{
\end{bclogo}
 \par \bigskip }


\newcounter{histo}
\newenvironment{histoire}[1]
{\par \medskip   \addtocounter{histo}{1} \noindent  
 \begin {bclogo}[couleur = blue!10 , arrondi =0.1,logo=\bchorloge, marge=4] {~\textbf{Histoire} \textbf{\thehisto} {\itshape #1} }  \par}
{
\end{bclogo}
 \par \bigskip }




%Environnement contenu pour un document présentant une progression annuelle
\newenvironment{contenu}
{\par \medskip   \begin {bclogo}[ noborder = true,logo=\bccrayon] \noindent {\large \textbf{Contenu de la séance}} \vspace*{10pt} \par  }
{\end{bclogo}  \par \medskip }

%Environnement programme pour un document présentant une progression annuelle
%\newenvironment{programme}
%{\par \medskip   \begin {bclogo}[ noborder = true, barre=zigzag,logo=\bcinfo] \noindent {\large \textbf{Programme officiel}} \vspace*{10pt} \par  }
%{\end{bclogo}  \par \medskip }

%Environnement programme pour un document présentant une progression annuelle
\newenvironment{ressource}
{\par \medskip   \begin {bclogo}[ noborder = true,logo=\bcbook] \noindent {\large \textbf{Ressources}}\\vspace*{10pt} \par }
{\end{bclogo}  \par \medskip }




%%%%%%%%%%%%%%%%%%Maths divers%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%Nombres%%%%%%%%%%%%%%%%

%Ensemble prive de...
%\newcommand{\prive}{\boi}%{\backslash}

%Ensembles de nombres%%%%%%%%%%%%%%%%%
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\D}{\mathbb{D}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
%\newcommand{\C}{\mathbb{C}}
\newcommand{\df}{~\ensuremath{]0;+\infty[}~}
\newcommand{\K}{\mathbb{K}}

%%%%%%%%Arithmetique%%%%%%%%%%
%PGCD, PPCM
\newcommand{\PGCD}{\mathop{\rm PGCD}\nolimits}
\newcommand{\PPCM}{\mathop{\rm PPCM}\nolimits}

%Intervalles
\newcommand{\interoo}[2]{]#1\, ;\, #2[}
\newcommand{\Interoo}[2]{\left]#1\, ;\, #2\right[}
\newcommand{\interof}[2]{]#1\, ;\, #2]}
\newcommand{\Interof}[2]{\left]#1\, ;\, #2\right]}
\newcommand{\interfo}[2]{[#1\, ;\, #2[}
\newcommand{\Interfo}[2]{\left[#1\, ;\, #2\right[}
\newcommand{\interff}[2]{[#1\, ;\, #2]}
\newcommand{\Interff}[2]{\left[#1\, ;\, #2\right]}
%\newcommand\interentiers #1#2{[\! [#1\, ;\, #2]\! ]}
\newcommand{\interentiers}[2]{\llbracket #1\, ;\, #2\rrbracket}
%


%%%%%%%%%%%%%%Nombres complexes%%%%%

\newcommand{\ic}{\text{i}}
%\newcommand{\I}{\text{i}}
\newcommand{\im}[1]{\text{Im}\left(#1\right)}
\newcommand{\re}[1]{\text{Re}\left(#1\right)}
\newcommand{\Arg}[1]{\text{arg}\left(#1\right)}
\newcommand{\Mod}[1]{\left[#1\right]}
%Parties entiÃ¨re, rÃ©elle, imaginaire, nombre i
\newcommand{\ent}[1]{\text{E}\left(#1\right)}
\renewcommand{\Re}{\mathop{\rm Re}\nolimits}
\renewcommand{\Im}{\mathop{\rm Im}\nolimits}
\renewcommand{\i}{\textrm{i}}

%%%%%%%%%%%Probabilites et statistiques%%%%%
\newcommand{\loibinom}[2]{\mathcal{B}\left(#1\ ; \ #2 \right)}
\newcommand{\loinorm}[2]{\mathcal{N}\left(#1\ ; \ #2 \right)}
\newcommand{\loiexp}[1]{\mathcal{E}\left(#1\right)}
\newcommand{\proba}[1]{\mathbb{P}\big(#1\big)}
\newcommand{\probacond}[2]{\mathbb{P}_{#2}\big(#1\big)}
\newcommand{\esperance}[1]{\mathbb{E}\left(#1\right)}
\newcommand{\variance}[1]{\mathbb{V}\left(#1\right)}
\newcommand{\ecart}[1]{\sigma\left(#1\right)}
\newcommand{\dnormx}{\frac{1}{\sqrt{2\pi}} \text{e}^{-\frac{x^2}{2}}}
\newcommand{\dnormt}{\frac{1}{\sqrt{2\pi}} \text{e}^{-\frac{t^2}{2}}}

%Covariance
\newcommand{\cov}{\mathop{\rm cov}\nolimits}
%


%%%%%%%%%%Analyse%%%%%%%%%%%

%%%%%%%%%%%Courbe%%%%%%%%%%%%
\newcommand{\courbe}[1]{\ensuremath{\mathcal{C}_{#1}}}

%%%%%%%Fonction exponentielle%%%%%
\newcommand{\fe}{~fonction exponentielle~}
\newcommand{\e}{\text{e}}

%Fonction cotangente
\newcommand{\cotan}{\mathop{\rm cotan}\nolimits}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%Fonctions hyperboliques
\newcommand{\ch}{\mathop{\rm ch}\nolimits}
\newcommand{\sh}{\mathop{\rm sh}\nolimits}


%%%%%%%%%%%%%%Limites%%%%%%
\newcommand{\limite}[2]{\lim\limits
_{x \to #1} #2}
\newcommand{\limitesuite}[1]{\lim\limits
_{n \to +\infty} #1}
\newcommand{\limiteg}[2]{\lim\limits
_{\substack{x \to #1 \\ x < #1 }} #2}
\newcommand{\limited}[2]{\lim\limits
_{\substack{x \to #1 \\ x > #1 }} #2}

%%%%%%%%%%Continuité%%%%%%%%%%%
\newcommand{\TVI}{théorème des valeurs intermédiaires}

%%%%%%%%%%%Suites%%%%%%%%%%%%
\newcommand{\suite}[1]{\ensuremath{\left(#1_{n}\right)}}
\newcommand{\Suite}[2]{\ensuremath{\left(#1\right)_{#2}}}
%

%%%%%%%%%%%%%%%Calcul intégral%%%%%%
\newcommand{\dx}{\ensuremath{\text{d}x}}		% dx
\newcommand{\dt}{\ensuremath{\text{d}t}}		% dt
\newcommand{\dtheta}{\ensuremath{\text{d}\theta}}		% dtheta
\newcommand{\dy}{\ensuremath{\text{d}y}}		% dy
\newcommand{\dq}{\ensuremath{\text{d}q}}		% dq

%%%Intégrale%%%
\newcommand{\integralex}[3]{\int_{#1}^{#2} #3 \ \dx}
\newcommand{\integralet}[3]{\int_{#1}^{#2} #3 \ \dt}
\newcommand{\integraletheta}[3]{\int_{#1}^{#2} #3 \ \dtheta}

%%%%%Equivalent%%
\newcommand{\equivalent}[1]{\build\sim_{#1}^{}}

%o et O%%%%
\renewcommand{\o}[2]{\build o_{#1\to #2}^{}}
\renewcommand{\O}[2]{\build O_{#1\to #2}^{}}



%%%%%%%%%%%%%%%Geometrie%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%Reperes%%%%%%%%%%%%%%
\def\Oij{\ensuremath{\left(\text{O},~\vect{\imath},~\vect{\jmath}\right)}}
\def\Oijk{\ensuremath{\left(\text{O},~\vect{\imath},~ \vect{\jmath},~ \vect{k}\right)}}
\def\Ouv{\ensuremath{\left(\text{O},~\vect{u},~\vect{v}\right)}}
\renewcommand{\ij}{(\vec\imath\, ;\vec\jmath\,)}
\newcommand{\ijk}{(\vec\imath\, ;\vec\jmath\, ;\vec k\,)}
\newcommand{\OIJ}{(O\,;\, I\,;\, J\,)}
\newcommand{\repere}[3]{\big(#1\, ;\,\vect{#2} ;\vect{#3}\big)}
\newcommand{\reperesp}[4]{\big(#1\, ;\,\vect{#2} ;\vect{#3} ;\vect{#4}\big)}

%%%%%%%%%Coordonnees%%%%%%%%%%%%%%
\newcommand{\coord}[2]{(#1\, ;\, #2)}
\newcommand{\bigcoord}[2]{\big(#1\, ;\, #2\big)}
\newcommand{\Coord}[2]{\left(#1\, ;\, #2\right)}
\newcommand{\coordesp}[3]{(#1\, ;\, #2\, ;\, #3)}
\newcommand{\bigcoordesp}[3]{\big(#1\, ;\, #2\, ;\, #3\big)}
\newcommand{\Coordesp}[3]{\left(#1\, ;\, #2\, ;\, #3\right)}
\newcommand{\Vcoord}[3]{\begin{pmatrix} #1 \\ #2 \\ #3 \end{pmatrix}}
%Symboles entre droites
%\newcommand{\paral}{\sslash}
\newcommand{\paral}{\mathop{/\!\! /}}
%

%%%%%%%%%Produit scalaire, Angles%%%%%%%%%%
\newcommand{\scal}[2]{\vect{#1} \, \cdot \, \vect{#2}}
\newcommand{\Angle}[2]{\left(\vect{#1} \, , \, \vect{#2}\right)}
\newcommand{\Anglegeo}[2]{\left(\widehat{\vect{#1} \, ; \, \vect{#2}}\right)}
\renewcommand{\angle}[1]{\widehat{#1}}
\newcommand{\anglevec}[2]{\left(\vect {#1}\, ,\,\vect {#2} \right)}
\newcommand{\anglevecteur}[2]{(#1\, , \, #2)}
\newcommand{\Anglevec}[2]{(\vecteur{#1}\, ,\,\vecteur{#2})}
\newcommand{\prodscal}[2]{#1 \, \cdot \, #2}
%


%Arc
%\newcommand{\arc}[1]{\wideparen{#1}}
\newcommand{\arcoriente}[1]{\overset{\curvearrowright}{#1}}
%
%


%%%%%%%%%%%%%%%Normes%%%%%%%%%%%%%%%%
\newcommand{\norme}[1]{\left\| #1\right\|}
\newcommand{\normebis}[1]{\delim{2pt}{\|}{9pt}\! #1\delim{2pt}{\|}{9pt}}
\newcommand{\normetriple}[1]{\left |\kern -.07em\left\| #1\right |\kern -.07em\right\|}
\newcommand{\valabs}[1]{\big| \, #1 \, \big|}
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%Degré%%%%%%
%\newcommand{\Degre}{\ensuremath{^\circ}}
%La commande \degre est déjà définie dans le package babel

%%%%%%%%%%Vecteurs%%%%%%%%%%%
\newcommand{\vect}[1]{\mathchoice%
{\overrightarrow{\displaystyle\mathstrut#1\,\,}}%
{\overrightarrow{\textstyle\mathstrut#1\,\,}}%
{\overrightarrow{\scriptstyle\mathstrut#1\,\,}}%
{\overrightarrow{\scriptscriptstyle\mathstrut#1\,\,}}}



%%%%%%%%%%%%%Algebre%%%%%%%%%%%%%%%


%%%%%%%%%%Systemes%%%%%%%%%%%
%Systemes
\newcommand{\sys}[2]{
\left\lbrace
 \begin{array}{l}
  \negthickspace\negthickspace #1\\
  \negthickspace\negthickspace #2\\
 \end{array}
\right.\negthickspace\negthickspace}
\newcommand{\Sys}[3]{
\left\lbrace
 \begin{array}{l}
  #1\\
  #2\\
  #3\\
 \end{array}
\right.}
\newcommand{\Sysq}[4]{
\left\lbrace
 \begin{array}{l}
  #1\\
  #2\\
  #3\\
  #4\\
 \end{array}
\right.}
%
%

%%%%%%%%%%%%%%%%Matrices%%%%%%%%%%%%%%%%%%
%Comatrice
\newcommand{\com}{\mathop{\rm com}\nolimits}
%
%
%Trace
\newcommand{\tr}{\mathop{\rm tr}\nolimits}
%
%
%Transposee
\newcommand{\transposee}[1]{{\vphantom{#1}}^t\negmedspace #1}
%
%
%Noyau
\newcommand{\Ker}{\mathop{\rm Ker}\nolimits}
%
%

%
%Matrices
\newcommand{\Mn}{\mathcal M_n}
\newcommand{\matrice}[4]{
\left(
 \begin{array}{cc}
  #1 & #2 \\
  #3 & #4
 \end{array}
\right)}

\newcommand{\Matrice}[9]{
\left(
 \begin{array}{ccc}
  #1 & #2 & #3\\
  #4 & #5 & #6\\
  #7 & #8 & #9
 \end{array}
\right)}
\newcommand{\Vect}[3]{
\left(\negmedspace
 \begin{array}{c}
  #1\\
  #2\\
  #3
 \end{array}\negmedspace
\right)}
\newcommand{\Ideux}{\matrice{1}{0}{0}{1}}
\newcommand{\Itrois}{\Matrice{1}{0}{0}{0}{1}{0}{0}{0}{1}}
%
%
%Determinants
\newcommand{\determinant}[4]{
\left|
 \begin{array}{cc}
  #1 & #2 \\
  #3 & #4
 \end{array}
\right|}
\newcommand{\Determinant}[9]{
\left|
 \begin{array}{ccc}
  #1 & #2 & #3\\
  #4 & #5 & #6\\
  #7 & #8 & #9
 \end{array}
\right|}

\begin{document}
\maketitle

\renewcommand*\contentsname{Table des matières}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{3}
\tableofcontents
}
\hypertarget{cruxe9dits}{%
\section*{Crédits}\label{cruxe9dits}}
\addcontentsline{toc}{section}{Crédits}

\emph{Ce cours a été construit à partir de plusieurs sources :
l'excellent cours de Julien de Villèle dont sont extraits certains
passages ; le chapitre 13 du manuel NSI de la collection Tortue chez
Ellipse, auteurs : Ballabonski, Conchon, Filliatre, N'Guyen ; les fiches
de cours 37 et 38 du Prepabac Première NSI chez Hatier, auteurs :
Laurent Signac et Guillaume Connan ; un QCM sur
\url{https://doctools.dgpad.net} réalisé par Alain Busser.}

\hypertarget{pruxe9sentation-du-probluxe8me-de-classification}{%
\section{Présentation du problème de
classification}\label{pruxe9sentation-du-probluxe8me-de-classification}}

\begin{activite}{}

En guise d'introduction au problème de classification par
\emph{l'algorithme des k plus proches voisins}, répondez au QCM réalisé
par Alain Busser, qui est proposé à l'adresse
\url{https://link.dgpad.net/dsFN}.

\end{activite}

Dans ce cours, on considère un exemple modèle constitué de 37 Pokemons
dont on donne ci-dessous une représentation graphique avec :

\begin{itemize}
\tightlist
\item
  en abscisse leur vitesse
\item
  en ordonnée leur défense
\item
  en couleur leur type : \emph{Feu} ou \emph{Roche}
\end{itemize}

\begin{center}

\begin{tabular}{c}

\begin{minipage}{0.8\linewidth}

\includegraphics[width=1\textwidth,height=\textheight]{images/pokemon-feu-roche-vitesse-defense.png}\\
\emph{Graphique 1 : Pokemons Feu ou Roche avec deux descripteurs}

\end{minipage} \end{tabular}

\end{center}

Les données peuvent être représentées sous forme d'une table contenant
37 enregistrements ayant cette forme :

\begin{lstlisting}[language=Python]
{'nom': 'Salameche',   'defense': '43',  'vitesse': '65',  'type': 'Feu'}
\end{lstlisting}

Chaque enregistrement contient ce qu'on appellera pour la suite :

\begin{itemize}
\tightlist
\item
  deux \textbf{descripteurs} \passthrough{\lstinline!'defense'!} et
  \passthrough{\lstinline!'vitesse'!} qui donnent la position du point,
\item
  une unique \textbf{étiquette} `type' qui donne la couleur du point.
\end{itemize}

\begin{remarque}{}

Les valeurs des descripteurs \passthrough{\lstinline!'defense'!} et
\passthrough{\lstinline!'vitesse'!} sont de type
\passthrough{\lstinline!str!} dans l'enregistrement. IL faut donc les
convertir en type \passthrough{\lstinline!int!} ou
\passthrough{\lstinline!float!} pour placer le point dans un repère. En
pratique les enregistrements sont extraits de fichiers textes , comme
des fichiers
\href{https://fr.wikipedia.org/wiki/Comma-separated_values}{CSV}, et les
descripteurs peuvent représenter des catégories (`mâle', `femelle'
\ldots{}) tout autant que des valeurs numériques. On a donc choisi de
garder toutes les valeurs en type \passthrough{\lstinline!str!} et de
les convertir selon les besoins de traitement.

\end{remarque}

\begin{cours}{}

Le \textbf{problème de classification} auquel \emph{l'algorithme des k
plus proches voisins} tente d'apporter une réponse est le suivant (les
trois formulations sont équivalentes) :

\begin{itemize}
\tightlist
\item
  Un nouveau Pokemon a pour \passthrough{\lstinline!'vitesse'!} 58 et
  pour \passthrough{\lstinline!'defense'!} 65, quel est son type ?
\item
  Un nouveau point a pour coordonnées (58 ; 65). Quelle est sa couleur ?
\item
  Un nouvel enregistrement a pour descripteurs
  \passthrough{\lstinline!'vitesse' : 58!} et
  \passthrough{\lstinline!'defense' : 65!}. Quelle est son étiquette ?
\end{itemize}

Sur le graphique, si on ne considère que le point vert le plus proche
(en mesurant à la règle), on peut attribuer l'étiquette `vert' (type
\emph{Roche}) au nouveau point. Mais si on considère les trois voisins
les plus proches , deux sur trois sont rouges et dans ce cas on attribue
l'étiquette `rouge' (type \emph{Feu}). On voit que le nombre de voisins
à considérer est important, de plus la distance doit être définie
précisément.

Le paramétrage de l'algorithme peut être effectué par un humain mais son
exécution par un ordinateur permet : * d'automatiser la réponse, * de
répondre rapidement à des milliers ou millions de questions du même
type, * de généraliser à des cas avec plus de deux descripteurs

\end{cours}

\hypertarget{algorithme-des-k-plus-proches-voisins}{%
\section{Algorithme des k plus proches
voisins}\label{algorithme-des-k-plus-proches-voisins}}

\begin{activite}{}

Regardez la petite video accessible depuis ce lien :
\url{algo_1_sur_2.gif}

\end{activite}

\begin{cours}{}

Les données sur lesquelles on applique \emph{l'algorithme des k plus
proches voisins} sont :

\begin{itemize}
\tightlist
\item
  une table d'enregistrements (dictionnaires Python) d'objets dont on
  connait \textbf{l'étiquette / la classification}, nommons la
  \passthrough{\lstinline!table\_pokemon!}. On peut remplacer
  enregistrement par : point, donnée ou Pokemon dans notre exemple.
\item
  l'enregistrement d'une nouvelle donnée dont on cherche
  \textbf{l'étiquette / la classification}, nommons le
  \passthrough{\lstinline!nouveau\_pokemon!}
\end{itemize}

Les paramètres de \emph{l'algorithme des k plus proches voisins} sont :

\begin{itemize}
\tightlist
\item
  Un \textbf{entier naturel \passthrough{\lstinline!k!}}, généralement
  impair et compris entre 3 et 10, qui correspond au nombre de voisins
  les plus proches qui seront examinés.
\item
  Une \textbf{fonction de distance} pour mesurer la proximité entre la
  nouvelle donnée et toutes les données déjà étiquetées de la table ce
  qui permettra de sélectionner les \passthrough{\lstinline!k!} plus
  proches. Cette distance est mesurée à partir des valeurs de certains
  descripteurs présents dans les enregistrements, comme
  \passthrough{\lstinline!'vitesse'!} et
  \passthrough{\lstinline!'defense'!} dans l'exemple du cours.
\end{itemize}

\emph{L'algorithme des k plus proches voisins} se déroule ainsi :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Pour chaque enregistrement / pokemon dans
  \passthrough{\lstinline!table\_pokemon!} on calcule la distance entre
  cet enregistrement et celui de
  \passthrough{\lstinline!nouveau\_pokemon!}. On stocke au fur et à
  mesure les couples
  \passthrough{\lstinline!(distance avec chaque  nouveau\_pokemon, étiquette de l'enregistrement / pokemon)!}
  dans un tableau \passthrough{\lstinline!tab\_distance!}.
\item
  On trie le tableau \passthrough{\lstinline!tab\_distance!} (qui
  contient des \passthrough{\lstinline!tuple!}
  \passthrough{\lstinline!(distance, étiquette)!}) dans l'ordre
  croissant selon le critère de distance.
\item
  On extrait les \passthrough{\lstinline!k!} plus petits éléments de
  \passthrough{\lstinline!tab\_distance!} qui correspondent aux
  \passthrough{\lstinline!k!} plus proches voisins de
  \passthrough{\lstinline!nouveau\_pokemon!} dans un tableau
  \passthrough{\lstinline!k\_voisins!}.
\item
  On sélectionne l'étiquette majoritaire dans le tableau
  \passthrough{\lstinline!k\_voisins!} et on l'attribue à
  \passthrough{\lstinline!nouveau\_pokemon!} parce que c'est le choix
  majoritaire parmi les \passthrough{\lstinline!k!} plus proches
  voisins.
\end{enumerate}

\end{cours}

\begin{exemple}{}

Détaillons les différentes étapes de \emph{l'algorithme des k plus
proches voisins} sur notre exemple de Pokemons.

\begin{itemize}
\tightlist
\item
  \textbf{Initialisation : chargement et traitement du jeu de données}
\end{itemize}

On charge le fichier
\href{https://fr.wikipedia.org/wiki/Comma-separated_values}{CSV}
contenant le jeu de données dans une table (un tableau d'enregistrements
qui sont des dictionnaires).

\begin{lstlisting}[language=Python]
In [1]: table_pokemons = charger_fichier_entete('./datas/pokemons.csv')

In [2]: table_pokemons[0]
Out[2]: 
{'nom': 'Rattata', 'vie': '30',
 'attaque': '56',  'defense': '35',
 'vitesse': '72',  'type': 'Normal'}
\end{lstlisting}

On filtre la table pour extraire les Pokemons de type Feu et Roche. Une
étape de traitement des données est souvent nécessaire.

\begin{lstlisting}[language=Python]
In [3]: table_pokemons_feu_roche = [pok for pok in table_pokemons 
   ...:                    if pok['type'] in ['Roche', 'Feu']]

In [4]: len(table_pokemons_feu_roche)
Out[4]: 37
\end{lstlisting}

\begin{itemize}
\tightlist
\item
  \textbf{Étape 1 : calcul des distances}
\end{itemize}

On calcule les distance entre le nouveau Pokemon et tous les Pokemons de
la table \passthrough{\lstinline!table\_pokemons\_feu\_roche!}.

\begin{lstlisting}[language=Python]
In [5]: nouveau_pokemon = {'vitesse':58, 'attaque' : 120 , 'defense' : 65, 'vie' : 100 }

In [6]: table_pokemons_feu_roche[0] #premier Pokemon de la table
Out[6]: 
{'nom': 'Salameche', 'vie': '39',
 'attaque': '52',  'defense': '43',
 'vitesse': '65',  'type': 'Feu'}

In [7]: salameche = table_pokemons_feu_roche[0]

In [8]: distance_euclidienne(nouveau_pokemon, salameche, ['vitesse', 'defense'])
Out[8]: 23.087

In [9]: tab_distance = table_distance_nouveau(table_pokemons_feu_roche, nouveau_pokemon, distance_euclidienne, 'type',                                      ['vitesse', 'defense'])

In [10]: tab_distance[:4]
Out[10]: [(18.385, 'Feu'), (22.091, 'Feu'), (21.19, 'Feu'), (44.598, 'Feu')]
\end{lstlisting}

\begin{itemize}
\tightlist
\item
  \textbf{Étapes 2 et 3 : tri et sélection des k plus proches voisins}
\end{itemize}

On fixe le paramètre, on trie dans l'ordre croissant le tableau
\passthrough{\lstinline!tab\_distance!} suivant le critère de distance
et on extrait les \passthrough{\lstinline!k!} plus proches voisins.

\begin{lstlisting}[language=Python]
In [11]: k_voisins = trier_puis_extraire(tab_distance, 5)

In [12]: k_voisins
Out[12]: ['Roche', 'Feu', 'Feu', 'Feu', 'Feu']
\end{lstlisting}

\begin{itemize}
\tightlist
\item
  \textbf{Étape 4 : sélection de l'étiquette majoritaire parmi les k
  plus proches voisins}
\end{itemize}

\begin{lstlisting}[language=Python]
In [19]: element_majoritaire(k_voisins)
Out[19]: 'Feu'
\end{lstlisting}

On peut rassemble toutes les fonctions précédentes en une seule qui
renvoie l'étiquette majoritaire parmi les \passthrough{\lstinline!k!}
plus proches voisins.

\begin{lstlisting}[language=Python]
def etiquetage_knn(table, nouveau, etiquette, tab_descripteur, k,
                   distance = distance_euclidienne):    
    tab_distance = table_distance_nouveau(table, nouveau, distance, etiquette, tab_descripteur)
    k_voisins = trier_puis_extraire(tab_distance, k)
    voisin_majoritaire = element_majoritaire(k_voisins)
    return voisin_majoritaire
\end{lstlisting}

On peut vérifier que cela donne le même résultat.

\begin{lstlisting}[language=Python]
In [20]: etiquetage_knn(table_pokemons_feu_roche, nouveau_pokemon, 'type', ['vitesse', 'defense'], 5)
Out[20]: 'Feu'
\end{lstlisting}

\end{exemple}

\hypertarget{choix-des-paramuxe8tres-et-limites-de-lalgorithme}{%
\section{Choix des paramètres et limites de
l'algorithme}\label{choix-des-paramuxe8tres-et-limites-de-lalgorithme}}

\hypertarget{le-choix-de-la-distance}{%
\subsection{Le choix de la distance}\label{le-choix-de-la-distance}}

\begin{center}

\begin{tabular}{cc}

\begin{minipage}{0.5\linewidth}

\includegraphics{images/distance-euclidienne-plan.png}\\

\end{minipage} &

\begin{minipage}{0.5\linewidth}

\includegraphics{images/distance-manhattan-plan.png}\\

\end{minipage} \end{tabular}

\end{center}

\emph{Graphique 2 : distances dans le plan}

\begin{cours}{}

Considérons un nouveau Pokemon et un Pokemon déjà connu dans une table :

\begin{lstlisting}[language=Python]
In [3]: nouveau_pokemon
Out[3]: {'vitesse': 58, 'attaque': 120, 'defense': 65, 'vie': 100}

In [4]: table_pokemons_feu_roche[1]
Out[4]: 
{'nom': 'Reptincel', 'vie': '58',  'attaque': '64',  'defense': '58',  'vitesse': '80',
 'type': 'Feu'}
\end{lstlisting}

\begin{itemize}
\tightlist
\item
  Si on caractérise chaque Pokemon par deux descripteurs
  \passthrough{\lstinline!'vitesse'!} et
  \passthrough{\lstinline!'defense'!}, on peut les représenter dans le
  plan par les points A de coordonnées \((58, 65)\) et B de coordonnées
  \((80, 58)\). On peut calculer la distance AB de plusieurs façons,
  comme par exemple :

  \begin{itemize}
  \tightlist
  \item
    La \textbf{distance euclidienne} qui correspond à celle de la règle
    graduée :\\
    \(AB=\sqrt{(x_{B}-x_{A})^{2}+(y_{B}-y_{A})^{2}}=\sqrt{(80-58)^{2}+(58-65)^{2}} \approx 23,087\)
  \item
    La \textbf{distance de Manhattan} qui correspond à la longueur du
    chemin parcouru pour aller de \(A\) à \(B\) en se déplaçant le long
    des arêtes d'un quadrillage généré par un repère orthonormé du plan,
    comme dans le plan d'une ville où les rues se coupent à angle droit
    :
    \(AB=\vert x_{B}-x_{A} \vert + \vert y_{B}-y_{A} \vert =\vert 80 - 58 \vert + \vert 58 - 65 \vert = 22 + 7 = 29\)
  \end{itemize}
\item
  Si on caractérise chaque Pokemon par trois descripteurs
  \passthrough{\lstinline!'vitesse'!},
  \passthrough{\lstinline!'defense'!} et
  \passthrough{\lstinline!'attaque'!} on peut les représenter dans
  l'espace par les points A de coordonnées \((58, 65, 120)\) et B de
  coordonnées \((80, 58, 64)\). On peut calculer la distance AB de
  plusieurs façons, comme par exemple en notant \(z\) la troisième
  coordonnée :

  \begin{itemize}
  \tightlist
  \item
    La \textbf{distance euclidienne} qui correspond à celle de la règle
    graduée :\\
    \(AB=\sqrt{(x_{B}-x_{A})^{2}+(y_{B}-y_{A})^{2} + (z_{B}-z_{A})^{2}}=\sqrt{(80-58)^{2}+ (58-65)^{2} + (120 - 64)^{2}} \approx 60,572\)
  \item
    La \textbf{distance de Manhattan} qui correspond à la longueur du
    chemin parcouru pour aller de \(A\) à \(B\) en se déplaçant le long
    des arêtes d'un quadrillage généré par un repère orthonormé du plan,
    comme dans le plan d'une ville où les rues se coupent à angle droit
    :
    \(AB=\vert x_{B}-x_{A} \vert + \vert y_{B}-y_{A} \vert =\vert 80 - 58 \vert + \vert 58 - 60 \vert + \vert 120 - 64 \vert = 22 + 7 + 56 = 85\)
  \end{itemize}
\item
  On peut généraliser les calculs de distances précédents à 4, 5 ou n
  descripteurs.
\end{itemize}

L'ensemble des k plus proches voisins dépend du choix de la distance qui
s'effectue en fonction du jeu de données.

De plus, il faut prêter attention aux différences d'échelles entre les
descripteurs : un écart de 50 n'a pas le même sens sur une
\passthrough{\lstinline!'vitesse'!} mesurée sur une échelle de 0 à 1000
et sur une \passthrough{\lstinline!'defense'!} mesurée sur une échelle
de 0 à 100. Il peut être intéressant, dans la phase de traitement des
données, de les normaliser en ramenant chaque valeur de descripteur dans
l'intervalle {[}0;1{]} avec le rapport
\(\frac{\text{valeur}-\text{valeurMin}}{\text{valeurMax}-\text{valeurMin}}\).

\end{cours}

Voici une représentation dans l'espace du jeu de données des 37 Pokemons
\emph{Roche} et \emph{Feu} avec trois descripteurs
\passthrough{\lstinline!'vitesse'!}, \passthrough{\lstinline!'defense'!}
et \passthrough{\lstinline!'attaque'!}. L'ajout d'un descripteur peut
permettre d'améliorer la classification en séparant plus nettement les
familles de points selon leur étiquette.

\begin{center}

\begin{tabular}{c}

\begin{minipage}{0.8\linewidth}

\includegraphics[width=1\textwidth,height=\textheight]{images/pokemon-feu-roche-vitesse-defense-attaque.png}\\
\emph{Graphique 3 : Pokemons Feu ou Roche avec trois descripteurs}

\end{minipage} \end{tabular}

\end{center}

\begin{exercice}{}

Dans le plan muni d'un repère orthonormé on a représenté cinq points
d'un jeu de données étiquetés :

\begin{itemize}
\tightlist
\item
  trois points d'étiquette `rond' : A, B et C
\item
  deux points d'étiquette `croix' : E et F
\end{itemize}

On considère un nouveau point D sans étiquette.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Déterminer les trois points les plus proches de D avec la
  \textbf{distance euclidienne}.
\item
  Déterminer les trois points les plus proches de D avec la
  \textbf{distance de Manhattan}.
\item
  Quelle est l'étiquette de D si on applique l'algorithme des k plus
  proches voisins avec k = 3 et la \textbf{distance euclidienne} ? et
  avec k = 3 et la \textbf{distance de Manhattan} ?
\end{enumerate}

\includegraphics[width=0.7\textwidth,height=\textheight]{images/distances.png}\\

\end{exercice}

\begin{exercice}{}

Les distances euclidienne ou de Manhattan s'appliquent à des
descripteurs qui prennent des valeurs numériques continues.

La \href{https://fr.wikipedia.org/wiki/Distance_de_Hamming}{distance de
Hammming} s'applique à des descripteurs qui sont des séquences de
symboles comme des chaînes de caractères ou des suites de bits 0 ou 1 et
prend pour valeur le nombre de symboles différents entre deux séquences.

Par exemple, on a
\passthrough{\lstinline!distance\_hamming('rat', 'raz') = 1!} ,
\passthrough{\lstinline!distance\_hamming('rat', 'rater') = 2!},
\passthrough{\lstinline!distance\_hamming('101', '011') = 2!} et
\passthrough{\lstinline!distance\_hamming('1010', '101') = 1!}.

Écrire en Python une fonction d'en-tête
\passthrough{\lstinline!distance\_hamming(chaine1, chaine2)!} qui
renvoie la distance de Hamming entre deux chaînes de caractères.

\end{exercice}

\hypertarget{le-choix-du-paramuxe8tre-k}{%
\subsection{\texorpdfstring{Le choix du paramètre
\texttt{k}}{Le choix du paramètre k}}\label{le-choix-du-paramuxe8tre-k}}

\begin{activite}{}

Regardez la petite video accessible depuis ce lien :
\url{algo_2_sur_2.gif}

\end{activite}

\begin{cours}{}

On reprend l'exemple initial du jeu de données de 37 Pokemons
\emph{Roche} et \emph{Feu} caractérisés par les deux descripteurs
\passthrough{\lstinline!'vitesse'!} et
\passthrough{\lstinline!'defense'!} et d'un nouveau Pokemon de
\passthrough{\lstinline!'vitesse' : 58!} et
\passthrough{\lstinline!'defense' : 65!} représentés sur le graphique 1.

On donne ci-dessous les étiquettes attribués par \emph{l'algorithme des
k plus proches voisins} avec k variant entre 1 et 9.

On observe la sensibilité aux perturbations locales pour les petites
valeurs de k : les des deux points les plus proches sont verts, de type
\emph{Roche} , mais les points dans un voisinage plus large sont
majoritairement rouges, de type \emph{Feu}.

D'un autre côté, une valeur de k trop grande prend en compte des points
éloignés et la classe majoritaire globalement finit par s'imposer.

En général, on choisit une valeur de k entre 3 et 10 et plutôt un entier
impair (pourquoi d'après vous ?)

\begin{lstlisting}[language=Python]
In [30]: nouveau_pokemon = {'vitesse':58, 'attaque' : 120 , 'defense' : 65, 'vie' : 100 }
    ...: for k in range(1, 11):
    ...:     print(f"k = {k}, etiquette = {etiquetage_knn(table_pokemons_feu_roche, nouveau_pokemon, 'type', ['vitesse', 'defense'], k)}")
    ...:     
k = 1, etiquette = Roche
k = 2, etiquette = Roche
k = 3, etiquette = Feu
k = 4, etiquette = Feu
k = 5, etiquette = Feu
k = 6, etiquette = Feu
k = 7, etiquette = Feu
k = 8, etiquette = Feu
k = 9, etiquette = Feu
k = 10, etiquette = Feu
\end{lstlisting}

\end{cours}

\hypertarget{les-limites-de-lalgorithme}{%
\subsection{Les limites de
l'algorithme}\label{les-limites-de-lalgorithme}}

\begin{cours}{}

\emph{L'algorithme des k plus proches voisins} permet de répondre à un
\textbf{problème de classification} pour tout type de données mais il
faut être conscient de ses limites :

\begin{itemize}
\tightlist
\item
  il faut calculer les distances entre une nouvelle donnée et toutes
  celles du jeu de données ce qui implique une complexité au moins
  linéaire en temps, ce qui n'est pas tolérable pour des jeux de données
  de grande taille ou des applications en temps réel
\item
  la qualité de la prédiction repose sur l'hypothèse que les données
  proches pour la distance choisie sont similaires à la nouvelle donnée
\item
  la qualité du jeu de données est cruciale comme pour tout algorithme
  de classification.
\end{itemize}

\end{cours}

\hypertarget{histoire-de-lintelligence-artificielle-et-des-algorithmes-dapprentissage}{%
\section{Histoire de l'intelligence artificielle et des algorithmes
d'apprentissage}\label{histoire-de-lintelligence-artificielle-et-des-algorithmes-dapprentissage}}

\begin{cours}{}

\emph{L'algorithme des k plus proches voisins} est un exemple simple
d'algorithme de classification par apprentissage (\emph{machine
learning}): il exploite un jeu de données connu pour apporter une
information, plausible mais pas forcément exacte sur une nouvelle
donnée. On

Cette famille d'algorithmes est rattachée à la branche de l'informatique
dénommée \textbf{intelligence artificielle} qui peut être définie comme
\emph{la conception des agents rationnels, autonomes et adaptatifs pour
résoudre des problèmes « comme ou mieux » que ne le ferait un être
humain}.

L'\textbf{intelligence artificielle} est apparue dès les débuts de
l'informatique dans les années 1950, le mythe d'une créature
artificielle intelligente étant un classique de la littérature (Golem,
Frankenstein \ldots{}). Après avoir connu, un \emph{hiver} pendant les
années 1980-1990, un renouveau important a lieu depuis les années 2000.
Le développement d'idées anciennes comme les réseaux de neurones a été
favorisé par une accélération des performances matérielles (GPU) et des
volumes de données disponibles (essor du web). Les réseaux de neurones
profonds (\emph{deep learning}) rendent possibles des applications
proches de certaines aptitudes considérées auparavant comme
caractéristiques de l'humain: reconnaissance d'image, du langage, prise
de décision \ldots{}

\end{cours}

\begin{exercice}{}

Compléter la frise ci-dessous avec ces événements marquants de
l'histoire de \textbf{l'intelligence artificielle} qui sont donnés dans
le désordre :

\begin{itemize}
\tightlist
\item
  test de Turing
\item
  victoire d'Alpha-Go sur le meilleur joueur humain de jeu de Go
\item
  premier neurone artificiel imaginé par Mc Culloch et Pitts
\item
  victoire de Watson (IBM) sur les meilleurs joueurs humains au jeu
  Jeopardy
\item
  victoire de Deep Blue (IBM) sur le champion du monde d'échec Gary
  Kasparov
\item
  invention du perceptron par Frank Rosenblatt
\item
  conférence de Darmouth
\item
  prix Turing décerné à Yann Le Cun pour ses travaux sur le Deep
  Learning
\end{itemize}

\end{exercice}

\begin{center}

\begin{tabular}{c}

\begin{minipage}{\linewidth}

\includegraphics[width=1\textwidth,height=\textheight]{images/timeline_knn_timeline.png}\\
\emph{Graphique 4 : histoire de l'intelligence artificielle}

\end{minipage} \end{tabular}

\end{center}

\hypertarget{synthuxe8se}{%
\section{Synthèse}\label{synthuxe8se}}

\begin{memo}{}

\emph{L'algorithme des k plus proches voisins} a pour but de classifier
une nouvelle donnée en lui attribuant une étiquette à partir des
étiquettes déjà connues d'un jeu de données similaires.

L'algorithme n'apporte pas une réponse exacte mais une prédiction dont
la qualité dépend du jeu de données, de la distance utilisée pour
mesurer la similarité entre deux données et du nombre k de voisins les
plus proches parmi lesquels l'étiquette majoritaire sera choisie.

La dernière décennie a connu un essor spectaculaire d'algorithmes e
classification par apprentissage bien plus performants et perfectionnés
qui s'appuient sur des jeux de données gigantesques et apportent des
réponses à des questions comme :

\begin{itemize}
\tightlist
\item
  Quelle est la classe de cet objet sur cette photo ? une voiture ? une
  moto ? une poussette ?
\item
  Quel est, au vu de ses données médicales, le diagnostic que l'on peut
  faire sur ce patient ? malade ou pas ?
\item
  Quel est, au vu de sa consommation précédente, le profil de ce
  consommateur streaming video ? quelles séries peut-on lui suggérer ?
\item
  Quel est, au vu de son dossier administratif, le profil de ce
  contribuable ? fraudeur ou pas ?
\end{itemize}

\end{memo}

\end{document}
