
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.1">
    
    
      
        <title>Page 2 - Première NSI Lycée du Parc</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.9299cb39.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
    
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#credits" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Première NSI Lycée du Parc" class="md-header__button md-logo" aria-label="Première NSI Lycée du Parc" data-md-component="logo">
      
  <img src="../../assets/logo-parc.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Première NSI Lycée du Parc
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Page 2
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo" type="radio" name="__palette" id="__palette_1">
          <label class="md-header__button md-icon" title="Mode sombre" for="__palette_2" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg>
          </label>
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue" type="radio" name="__palette" id="__palette_2">
          <label class="md-header__button md-icon" title="Mode clair" for="__palette_1" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg>
          </label>
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Progression
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../automatismes/" class="md-tabs__link md-tabs__link--active">
        Section 2
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Première NSI Lycée du Parc" class="md-nav__button md-logo" aria-label="Première NSI Lycée du Parc" data-md-component="logo">
      
  <img src="../../assets/logo-parc.png" alt="logo">

    </a>
    Première NSI Lycée du Parc
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Progression
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Section 2
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Section 2" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Section 2
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../automatismes/" class="md-nav__link">
        Page 1
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Page 2
      </a>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <ul>
<li><a href="#crédits">Crédits</a></li>
<li><a href="#table-de-données">Table de données</a></li>
<li><a href="#échange-de-table-de-données-avec-un-fichier-csv">Échange de table de données avec un fichier
    CSV</a></li>
<li><a href="#manipulation-de-fichiers-csv-en-python">Manipulation de fichiers CSV en
    Python</a></li>
<li><a href="#synthèse">Synthèse</a></li>
</ul>
<h1 id="credits">Crédits<a class="headerlink" href="#credits" title="Permanent link">⚓︎</a></h1>
<p><em>Ce cours est largement inspiré de deux sources :</em></p>
<ul>
<li><em>le chapitre 15 du manuel NSI de la collection Tortue chez Ellipse,
    auteurs : Ballabonski, Conchon, Filliatre, N’Guyen ;</em></li>
<li><em>le cours de Julien de Villèle</em>.</li>
</ul>
<h1 id="table-de-donnees">Table de données<a class="headerlink" href="#table-de-donnees" title="Permanent link">⚓︎</a></h1>
<div class="admonition abstract">
<p class="admonition-title">Histoire 1</p>
<p>L'homme organisait les données sous forme de tableau bien avant l'invention de l'ordinateur : les <strong>données tabulaires</strong>  ou <strong>tables de données</strong>, apparaissent déjà dans les livres de compte de l'Égypte ancienne. De nos jours les relevés de comptes bancaires sont encore présentés sous forme de tableaux avec pour chaque opération sa date, sa nature (débit ou crédit) et son montant.</p>
<p>En informatique, les  <strong>tables de données</strong>  se sont  développées dans dans les années 1970 avec l'essor   des <a href="https://fr.wikipedia.org/wiki/Syst%C3%A8me_de_gestion_de_base_de_donn%C3%A9es">Systèmes de Gestion de Base de Données</a> s'appuyant sur le <strong>modèle relationnel</strong>  proposé par <a href="https://fr.wikipedia.org/wiki/Edgar_Frank_Codd">Edgar F. Codd</a> chez IBM.  Les <a href="https://fr.wikipedia.org/wiki/Syst%C3%A8me_de_gestion_de_base_de_donn%C3%A9es">Systèmes de Gestion de Base de Données</a> permettent aujourd'hui le traitement automatique de gigantesques bases de données, qui est un élément fondamental dans nos sociétés de l'information. </p>
<p>Les <a href="https://fr.wikipedia.org/wiki/Syst%C3%A8me_de_gestion_de_base_de_donn%C3%A9es">Systèmes de Gestion de Base de Données</a> seront étudiés en classe de terminale. Nous présenterons cette année les traitements de <strong>tables de données</strong>  qui peuvent être effectués à l'aide de scripts Python, ce qui couvre  déjà un large champ de besoins en <em>data science</em>, <em>bio-informatique</em>, <em>informatique financière ou de gestion</em> ...</p>
</div>
<div class="admonition note">
<p class="admonition-title">Définition 1</p>
<p>Une feuille de tableur est un modèle  de <strong>données tabulaires</strong> ou <strong>table de données</strong>.</p>
<p>Définissons le vocabulaire :</p>
<ul>
<li>
<p>Une <strong>table</strong>, représentée sous forme de tableau, est une collection d'éléments qui sont les lignes du tableau.</p>
</li>
<li>
<p>Chaque élément de la <strong>table</strong>, ou ligne de sa représentation sous forme de tableau, s'appelle un <strong>enregistrement</strong>.</p>
</li>
<li>
<p>Tous les  <strong>enregistrements</strong> d'une même <strong>table</strong> sont des  <strong>p-uplets nommés</strong> qui partagent les mêmes <strong>descripteurs</strong>, appelés aussi <strong>attributs</strong>. Dans une représentation de la <strong>table</strong> sous forme de tableau, chaque <strong>attribut</strong> correspond à une colonne. Chaque <strong>attribut</strong> est caractérisé par son <strong>type</strong> et son  <strong>domaine de valeurs</strong>.</p>
</li>
<li>
<p>Dans une représentation sous forme de tableau, les <strong>descripteurs</strong> ou <strong>attributs</strong> sont en général placés comme en-tête de colonnes sur la première ligne.</p>
</li>
</ul>
</div>
<p><img alt="tableur" src="../images/tableur.png" />  </p>
<div class="admonition example">
<p class="admonition-title">Example 1</p>
<p>La table représentée ci-dessus rassemble les enregistrements des clients d'un site web marchand. Les attributs de cette table sont :</p>
<ul>
<li>le <em>nom</em> et le <em>prénom</em> du client de type chaîne de caractères</li>
<li><em>l'adresse mail</em> du client  du type chaîne de caractères avec un domaine de valeurs particulier</li>
<li>le <em>département</em> du client du type chaîne de caractères avec un domaine de valeurs particulier</li>
<li>le <em>nombre de visites</em> du client de type entier  avec pour domaine de valeurs les entiers positifs</li>
<li>les <em>dépenses</em> du client de type flottant avec pour domaine de valeurs les flottants positifs</li>
</ul>
</div>
<h1 id="echange-de-table-de-donnees-avec-un-fichier-csv">Échange de table de données avec un fichier CSV<a class="headerlink" href="#echange-de-table-de-donnees-avec-un-fichier-csv" title="Permanent link">⚓︎</a></h1>
<div class="admonition note">
<p class="admonition-title">Point de cours1</p>
<p>Pour échanger des <strong>données tabulaires</strong>  entre les programmes qui doivent les manipuler, on les exporte puis les importe sous la forme de fichiers textes, c'est-à-dire lisibles par l'être humain.  </p>
<p>Afin d'assurer l'interopérabilité entre différents programmes, un fichier doit respecter un <strong>format</strong> normalisé.</p>
<p>L'un des formats les plus répandus pour l'échange de <strong>données tabulaires</strong> est le format <a href="https://fr.wikipedia.org/wiki/Comma-separated_values">CSV</a> pour <em>Comma Separated Values</em> :</p>
<ul>
<li>un fichier <a href="https://fr.wikipedia.org/wiki/Comma-separated_values">CSV</a> est un fichier texte donc éditable avec un éditeur de textes comme <a href="https://notepad-plus-plus.org/downloads/">Notepad++</a> ;</li>
<li>chaque ligne du fichier correspond à un <strong>enregistrement</strong> de la table</li>
<li>pour un  <strong>enregistrement</strong> donné, les valeurs des différents <strong>attributs</strong> sont séparées en <strong>champs</strong> par un <strong>délimiteur</strong> qui est en général l'un des symboles <code>,</code> ou <code>;</code> ou <code>:</code>.</li>
<li>la première ligne contient en général les noms des <strong>attributs</strong>.</li>
<li>les champs peuvent être délimités par des guillemets droits <code>"</code> s'ils contiennent du texte avec des espaces ou des sauts de ligne. Le caractère <code>"</code> est alors échappé en <code>""</code> pour le distinguer des guillemets droits délimiteurs.</li>
</ul>
<p>Voici un extrait d'un fichier <a href="https://fr.wikipedia.org/wiki/Comma-separated_values">CSV</a> correspondant à la table présentée dans l'exemple 1 :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>nom,prénom,email,département,naissance,visites,dépenses
Gomes,Brigitte,bgomes@laposte.net,79,1960-08-21,67,8342.99
Nicolas,Georges,gnicolas@yahoo.fr,10,1994-05-26,86,10908.08
Berger,Pénélope,pberger@noos.fr,73,2001-03-01,131,3817.79
Charrier,Richard,rcharrier@sfr.fr,2B,1977-08-07,16,997.09
</code></pre></div>
</td></tr></table>
<p>On donne ci-dessous un autre extrait de fichier <a href="https://fr.wikipedia.org/wiki/Comma-separated_values">CSV</a> qui est un export de fichier d'identifiants de l'Espace Numérique de Travail (avec valeurs modifiées). La table comporte 19 attributs de <code>rne</code> à <code>pays</code> listés sur la première ligne. Le premier enregistrement figure sur la deuxième ligne avec pour valeur du premier champ <code>0690026D</code> et sept champs vides à la fin.</p>
<p>On observe que le délimiteur de champ est le symbole <code>;</code>, que les champs peuvent contenir des espaces, que certains sont vides et que le nombre de champs pour le premier enregistrement  ne correspond pas au nombre d'attributs ! On peut imaginer que pour traiter un tel fichier avec un programme, il faut d'abord analyser sa structure, ses particularités et prévoir d'éventuelles irrégularités dans les données (absence, erreurs de type, de saisie, corruption du fichier ...). Le <strong>contrôle de la  validité</strong> des données doit donc être une composante du programme de traitement.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>rne;uid;classe;profil;prenom;nom;login;mot de passe;cle de jointure;uid pere;uid mere;uid tuteur1;uid tuteur2;prenom enfant;nom enfant;adresse;code postal;ville;pays
0690026D;WKZ08710;813;Eleve;Mathieu;DUPONT;mathieu.dupont;&gt;&gt;&gt;&gt; Mot de passe déjà modifié par utilisateur &gt;&gt;&gt;&gt;;AC-LYON$3780909;WKZ02158;WKZ02171;;;;;;;;
</code></pre></div>
</td></tr></table>
</div>
<div class="admonition tip">
<p class="admonition-title">Exercice 1</p>
<p><em>Questions type E3C</em> </p>
<ol>
<li>Dans la plupart des fichiers CSV, que contient la première ligne ?</li>
<li><strong>Réponse A :</strong> des notes concernant la table de données  </li>
<li><strong>Réponse B :</strong> les sources des données  </li>
<li><strong>Réponse C :</strong> les descripteurs des champs de la table de données  </li>
<li><strong>Réponse D :</strong> l'auteur de la table de données</li>
<li>Laquelle de ces affirmations est vraie ?</li>
<li><strong>Réponse A :</strong> on ne peut accéder au contenu d'un fichier CSV que par
   l'intermédiaire d'un programme Python</li>
<li><strong>Réponse B :</strong> CSV est un format de chiffrement des données  </li>
<li><strong>Réponse C :</strong> le format CSV a été conçu pour assurer la confidentialité d'une
   partie du code d'un programme</li>
<li><strong>Réponse D :</strong> les fichiers CSV sont composés de données séparées par des caractères
   comme des virgules</li>
<li>Qu'est-ce que le format de fichier CSV ?</li>
<li><strong>Réponse A :</strong> un format de fichier mis au point par Microsoft pour Excel </li>
<li><strong>Réponse B :</strong> un format de fichier pour décrire une base de donnée  </li>
<li><strong>Réponse C :</strong> un format de fichier où les données sont séparées par un caractère tel
   qu'une virgule</li>
<li><strong>Réponse D :</strong> un format de fichier décrivant une page Web</li>
</ol>
</div>
<h1 id="manipulation-de-fichiers-csv-en-python">Manipulation de fichiers CSV en Python<a class="headerlink" href="#manipulation-de-fichiers-csv-en-python" title="Permanent link">⚓︎</a></h1>
<div class="admonition note">
<p class="admonition-title">Définition 2</p>
<p><strong>L'indexation de table</strong> est la création d'une structure de données à partir de données tabulaires.</p>
<p>Nous allons présenter quelques méthodes d'indexation de table extraite d'un fichier CSV vers une structure de données du langage Python : <strong>tableau de tableaux</strong> ou <strong>tableau de dictionnaires</strong> que nous privilégierons.</p>
</div>
<p>Dans cette section, on considère le fichier
<a href="https://fr.wikipedia.org/wiki/Comma-separated_values">CSV</a>,
<code>clients_mini.csv</code>, représentant un extrait de la table de l’exemple 1
avec les enregistrements de 20 clients d’un site web marchand.</p>
<div class="admonition success">
<p class="admonition-title">Méthode 1</p>
<p>Présentons deux méthodes de lecture de fichiers <a href="https://fr.wikipedia.org/wiki/Comma-separated_values">CSV</a> qui utilisent les outils standards de Python. </p>
<p>On fait les hypothèses suivantes :  la première ligne du fichier contient les attributs
et on connaît  le délimiteur, ici le symbole <code>,</code>.</p>
<ul>
<li><strong>Lecture</strong></li>
</ul>
<p>On peut extraire les attributs et la  table contenus dans le fichier <code>clients_mini.csv</code>  avec le code ci-dessous :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">fichier</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;clients_mini.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span> <span class="n">newline</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>   <span class="c1">#ouverture du fichier</span>
<span class="n">attributs</span> <span class="o">=</span> <span class="n">fichier</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>  <span class="c1">#extraction de la ligne des attributs</span>
<span class="n">table</span> <span class="o">=</span> <span class="p">[</span><span class="n">ligne</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">ligne</span> <span class="ow">in</span> <span class="n">fichier</span><span class="p">]</span>  <span class="c1">#extraction des autres lignes</span>
<span class="n">fichier</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>   <span class="c1">#fermeture du fichier </span>
</code></pre></div>
</td></tr></table>
<p>La méthode <code>open</code> permet de créer un objet <code>fichier</code> qu'on peut parcourir ligne par ligne avec un curseur : d'abord la première ligne avec <code>fichier.readline()</code> puis les lignes suivantes en itérant sur <code>fichier</code>. Il est important de préciser <strong>l'encodage du fichier</strong>, par défaut c'est celui du système d'exploitation.</p>
<p>Chaque ligne est une chaîne de caractères découpée en liste de champs selon le délimiteur passé en paramètre à la méthode <code>split</code>. Le caractère de saut de lignes a d'abord été supprimé avec la méthode <code>rstrip</code>.</p>
<p>On récupère ainsi les attributs comme un tableau de type <code>list</code> et la table comme un tableau d'enregistrements qui sont eux-mêmes des tableaux. Notons que toutes les valeurs sont des chaînes de caractères et qu'il faudra convertir certaines pour les traiter !</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">attributs</span>   <span class="c1">#tableau des attributs</span>
<span class="p">[</span><span class="s1">&#39;nom&#39;</span><span class="p">,</span> <span class="s1">&#39;prénom&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;département&#39;</span><span class="p">,</span> <span class="s1">&#39;naissance&#39;</span><span class="p">,</span> <span class="s1">&#39;visites&#39;</span><span class="p">,</span> <span class="s1">&#39;dépenses&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="c1">#tableau premier enregistrement </span>
<span class="p">[</span><span class="s1">&#39;Gomes&#39;</span><span class="p">,</span> <span class="s1">&#39;Brigitte&#39;</span><span class="p">,</span> <span class="s1">&#39;bgomes@laposte.net&#39;</span><span class="p">,</span> <span class="s1">&#39;79&#39;</span><span class="p">,</span> <span class="s1">&#39;1960-08-21&#39;</span><span class="p">,</span> <span class="s1">&#39;67&#39;</span><span class="p">,</span> <span class="s1">&#39;8342.99&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">table</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>   <span class="c1">#tableau de tableaux : extrait </span>
<span class="p">[[</span><span class="s1">&#39;Gomes&#39;</span><span class="p">,</span> <span class="s1">&#39;Brigitte&#39;</span><span class="p">,</span> <span class="s1">&#39;bgomes@laposte.net&#39;</span><span class="p">,</span> <span class="s1">&#39;79&#39;</span><span class="p">,</span> <span class="s1">&#39;1960-08-21&#39;</span><span class="p">,</span> <span class="s1">&#39;67&#39;</span><span class="p">,</span> <span class="s1">&#39;8342.99&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;Nicolas&#39;</span><span class="p">,</span> <span class="s1">&#39;Georges&#39;</span><span class="p">,</span> <span class="s1">&#39;gnicolas@yahoo.fr&#39;</span><span class="p">,</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;1994-05-26&#39;</span><span class="p">,</span> <span class="s1">&#39;86&#39;</span><span class="p">,</span> <span class="s1">&#39;10908.08&#39;</span><span class="p">]]</span>
</code></pre></div>
</td></tr></table>
<ul>
<li><strong>Écriture</strong></li>
</ul>
<p>On peut ensuite recopier les attributs et la table dans un autre fichier <code>clients_mini_copie.csv</code> avec le code ci-dessous :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">g</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;clients_mini_copie.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span> <span class="n">newline</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">premiere_ligne</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">attributs</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="n">g</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">premiere_ligne</span><span class="p">)</span>
<span class="k">for</span> <span class="n">enregistrement</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
    <span class="n">g</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">enregistrement</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
<p>La méthode <code>join</code> permet de concaténer les éléments d'un tableau de chaînes de caractères avec un délimiteur.</p>
<ul>
<li>Avec ces méthodes, une table est donc représentée par <strong>un tableau de tableaux</strong>. On accède à un enregistrement par son index dans la table et à la valeur d'un attribut par son index dans le tableau des attributs (séparé de la table). C'est incommode et  le code produit est peu lisible. Ainsi, pour accéder à l'adresse mail du premier enregistrement il faut saisir <code>table[0][2]</code>. On aimerait écrire <code>table[0]['email']</code>. Pour cela, chaque enregistrement devrait être un dictionnaire avec pour clefs les attributs de la table. C'est possible en utilisant le <a href="https://docs.python.org/fr/3/library/csv.html">module <code>csv</code></a>.</li>
</ul>
</div>
<div class="admonition success">
<p class="admonition-title">Méthode 2</p>
<p>Le <a href="https://docs.python.org/fr/3/library/csv.html">module <code>csv</code></a>  est disponible dans la bibliothèque standard et peut donc être  utilisé sans installation spécifique. À partir de la table contenu dans le même fichier CSV <code>'clients_mini.csv'</code>, ce module permet de créer une structure de données d'un accès plus facile.</p>
<ul>
<li><strong>Lecture</strong></li>
</ul>
<p>Le code ci-dessous permet d'extraire directement la table d'un fichier CSV dans une structure de données qui est un <strong>tableau de dictionnaires</strong> : chaque enregistrement est un dictionnaire dont les clefs sont les attributs listés sur la première ligne du fichier.</p>
<p>Pour les versions de Python 3.6 et 3.7 uniquement, les dictionnaires renvoyés sont spécifiques, de type <code>OrderedDict</code>, et on prendra soin de les convertir en dictionnaires standard avec <code>dict</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">csv</span>  <span class="c1"># import du module </span>

<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;clients_mini.csv&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span> <span class="n">newline</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>  <span class="c1">#création d&#39;un objet reader</span>
<span class="n">table</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">enregistrement</span><span class="p">)</span> <span class="k">for</span> <span class="n">enregistrement</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">]</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
<p>La structure de données représentant la table est un <strong>tableau de dictionnaires</strong> : l'accès aux enregistrements se fait par index et à leurs attributs par clef : très efficace (coût constant) et code lisible. Notons que toutes les valeurs restent des chaînes de caractères et qu'il faudra convertir certaines pour les traiter !</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="c1">#premier enregistrement de type dictionnaire</span>
<span class="p">{</span><span class="s1">&#39;nom&#39;</span><span class="p">:</span> <span class="s1">&#39;Gomes&#39;</span><span class="p">,</span> <span class="s1">&#39;prénom&#39;</span><span class="p">:</span> <span class="s1">&#39;Brigitte&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;bgomes@laposte.net&#39;</span><span class="p">,</span> <span class="s1">&#39;département&#39;</span><span class="p">:</span> <span class="s1">&#39;79&#39;</span><span class="p">,</span> <span class="s1">&#39;naissance&#39;</span><span class="p">:</span> <span class="s1">&#39;1960-08-21&#39;</span><span class="p">,</span> <span class="s1">&#39;visites&#39;</span><span class="p">:</span> <span class="s1">&#39;67&#39;</span><span class="p">,</span> <span class="s1">&#39;dépenses&#39;</span><span class="p">:</span> <span class="s1">&#39;8342.99&#39;</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">table</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># tableu de dictionnaires : extrait</span>
<span class="p">[{</span><span class="s1">&#39;nom&#39;</span><span class="p">:</span> <span class="s1">&#39;Gomes&#39;</span><span class="p">,</span> <span class="s1">&#39;prénom&#39;</span><span class="p">:</span> <span class="s1">&#39;Brigitte&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;bgomes@laposte.net&#39;</span><span class="p">,</span> <span class="s1">&#39;département&#39;</span><span class="p">:</span> <span class="s1">&#39;79&#39;</span><span class="p">,</span> <span class="s1">&#39;naissance&#39;</span><span class="p">:</span> <span class="s1">&#39;1960-08-21&#39;</span><span class="p">,</span> <span class="s1">&#39;visites&#39;</span><span class="p">:</span> <span class="s1">&#39;67&#39;</span><span class="p">,</span> <span class="s1">&#39;dépenses&#39;</span><span class="p">:</span> <span class="s1">&#39;8342.99&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;nom&#39;</span><span class="p">:</span> <span class="s1">&#39;Nicolas&#39;</span><span class="p">,</span> <span class="s1">&#39;prénom&#39;</span><span class="p">:</span> <span class="s1">&#39;Georges&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;gnicolas@yahoo.fr&#39;</span><span class="p">,</span> <span class="s1">&#39;département&#39;</span><span class="p">:</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;naissance&#39;</span><span class="p">:</span> <span class="s1">&#39;1994-05-26&#39;</span><span class="p">,</span> <span class="s1">&#39;visites&#39;</span><span class="p">:</span> <span class="s1">&#39;86&#39;</span><span class="p">,</span> <span class="s1">&#39;dépenses&#39;</span><span class="p">:</span> <span class="s1">&#39;10908.08&#39;</span><span class="p">}]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<span class="mi">20</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;email&#39;</span><span class="p">]</span>   <span class="c1">#accès facile aux valeurs des attibuts par clefs</span>
<span class="s1">&#39;bgomes@laposte.net&#39;</span>
</code></pre></div>
</td></tr></table>
<ul>
<li><strong>Écriture</strong></li>
</ul>
<p>L'écriture d'un tableau de dictionnaires partageant les mêmes clefs sous forme de table dans un fichier CSV, s'effectue de façon symétrique à travers un objet <code>DictWriter</code>. À titre, d'exemple, on recopie la table extraite précédemment dans un autre fichier CSV. Depuis Python 3.7, le parcours des clefs d'un dictionnaire est garanti dans le même ordre que celui d'insertion donc on peut récupérer la liste des attributs avec <code>list(table[0].keys())</code></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">g</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;clients_mini_copie2.csv&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span> <span class="n">newline</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">attributs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictWriter</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">fieldnames</span> <span class="o">=</span> <span class="n">attributs</span><span class="p">)</span> <span class="c1">#création de l&#39;objet writer</span>
<span class="n">writer</span><span class="o">.</span><span class="n">writeheader</span><span class="p">()</span>   <span class="c1">#écriture des attributs</span>
<span class="k">for</span> <span class="n">enregistrement</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">enregistrement</span><span class="p">)</span>  <span class="c1">#écriture des enregistrements</span>
<span class="n">g</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
<ul>
<li><strong>Remarque</strong> </li>
</ul>
<p>Le module <code>csv</code> permet aussi d'extraire une table d'un fichier CSV sous forme de <strong>tableau de tableaux</strong> comme dans la méthode précédente. Le découpage des lignes/enregistrements selon le délimiteur est intégré ce qui simplifie le code.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;clients_mini.csv&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="p">[</span><span class="n">ligne</span> <span class="k">for</span> <span class="n">ligne</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">]</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
</div>
<div class="admonition tip">
<p class="admonition-title">Exercice 2</p>
<p>Le fichier <code>clients_avec_erreurs.csv</code> contient une table de la même structure que celle de l'exemple 1 mais avec des données invalides :</p>
<ul>
<li>pour l'attribut <code>'email'</code> : format incorrect ou adresse manquante</li>
<li>pour l'attribut <code>'département'</code> : valeur incorrecte</li>
<li>pour l'attribut <code>'naissance'</code> : année hors postérieure à 2005 (pas de clients de moins de 15 ans !), mois hors de la plage [1,12], jour hors de la plage possible pour l'année et le mois fixé.</li>
<li>pour les attributs : <code>'visites'</code> et '<code>dépenses</code>' : valeurs négatives</li>
</ul>
<p>L'objectif de cet exercice est d'extraire la table du fichier, de filtrer les enregistrements valides et de les recopier dans un fichier <code>'clients_sans_erreurs.csv'</code>.</p>
<ol>
<li>Ouvrir le fichier <code>cours_exercices_tables_eleve.py</code> dans un IDE Python.</li>
<li>
<p>Compléter les fonctions de lecture / écriture d'une table représentée par un tableau de dictionnaires vers un fichier CSV :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">lecture_csv</span><span class="p">(</span><span class="n">fichier</span><span class="p">,</span> <span class="n">delimiteur</span><span class="p">):</span>   
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fichier</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span> <span class="n">newline</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="n">delimiteur</span><span class="p">)</span>  





    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">table</span>

<span class="k">def</span> <span class="nf">ecriture_csv</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">fichier</span><span class="p">,</span> <span class="n">delimiteur</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fichier</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf8&#39;</span><span class="p">,</span> <span class="n">newline</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">attributs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictWriter</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="n">delimiteur</span><span class="p">,</span> <span class="n">fieldnames</span> <span class="o">=</span> <span class="n">attributs</span><span class="p">)</span> 





    <span class="n">g</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
</li>
<li>
<p>Compléter les fonctions <code>bissextile</code>, <code>valide_mois</code>, <code>valide_jour</code>  puis la fonction <code>valide_naissance</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">bissextile</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Paramètre : a de type int représentant une année</span>
<span class="sd">    Valeur renvoyée  : booléen indiquant si l&#39;année est bissextile&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">.....</span>

<span class="k">def</span> <span class="nf">valide_annee</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1900</span> <span class="o">&lt;=</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">2005</span>

<span class="k">def</span> <span class="nf">valide_mois</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Paramètre : m de type int représentant un mois</span>
<span class="sd">    Valeur renvoyée  : booléen indiquant si le mois est valide (entre 1 et 12)&quot;&quot;&quot;</span>
    <span class="k">return</span>  <span class="o">....</span>


<span class="k">def</span> <span class="nf">valide_jour</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Paramètre : a, m, j de type int représentant l&#39;année, le mois et le jour</span>
<span class="sd">    Valeur renvoyée  : booléen indiquant si le jour est valide pour l&#39;année et le mois donnés&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">....</span>


<span class="k">def</span> <span class="nf">valide_naissance</span><span class="p">(</span><span class="n">date</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Paramètre : date de type str au format &#39;année-mois-jour&#39;, ex: &#39;2002-01-07&#39;</span>
<span class="sd">    Valeur renvoyée  : booléen indiquant si le jour est valide pour l&#39;année et le mois donnés</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">......</span>
        <span class="o">......</span>
</code></pre></div>
</td></tr></table>
</li>
<li>
<p>Les fonctions <code>valide_email</code>, <code>valide_departement</code>, <code>valide_visites</code> et <code>valide_depenses</code> sont fournies, compléter la fonction <code>valide_enregistrement</code> :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">valide_enregistrement</span><span class="p">(</span><span class="n">enreg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Paramètre : un enregistrement de type dictionnaire</span>
<span class="sd">    Valeur renvoyée  : booléen indiquant si toutes les valeurs des attributs sont valides</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">.......................................................</span>
            <span class="o">.......................................................</span>
            <span class="o">.......................................................</span>
</code></pre></div>
</td></tr></table>
</li>
<li>
<p>Si un enregistrement extrait du fichier CSV est validé, on peut convertir les valeurs de ces attributs dans le type attendu pour effectuer un traitement : <code>int</code> pour <code>'visites'</code> et <code>float</code>  pour <code>'dépenses'</code> et <code>str</code> pour les autres.  Compléter la fonction <code>conversion_vers_table</code> ci-dessous pour qu'elle renvoie une copie de l'enregistrement (de type <code>dict</code>) passé en paramètre avec les types attendus pour chaque attribut.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">conversion_vers_table</span><span class="p">(</span><span class="n">enregistrement</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span> <span class="s1">&#39;nom&#39;</span> <span class="p">:</span> <span class="n">enregistrement</span><span class="p">[</span><span class="s1">&#39;nom&#39;</span><span class="p">],</span>
            <span class="s1">&#39;prénom&#39;</span>  <span class="p">:</span> <span class="n">enregistrement</span><span class="p">[</span><span class="s1">&#39;prénom&#39;</span><span class="p">],</span>
            <span class="s1">&#39;email&#39;</span> <span class="p">:</span> <span class="n">enregistrement</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">],</span>
            <span class="s1">&#39;département&#39;</span> <span class="p">:</span> <span class="n">enregistrement</span><span class="p">[</span><span class="s1">&#39;département&#39;</span><span class="p">],</span>
            <span class="s1">&#39;naissance&#39;</span> <span class="p">:</span> <span class="n">enregistrement</span><span class="p">[</span><span class="s1">&#39;naissance&#39;</span><span class="p">],</span>
            <span class="s1">&#39;visites&#39;</span> <span class="p">:</span> <span class="o">...............................</span> <span class="p">,</span>
            <span class="s1">&#39;dépenses&#39;</span> <span class="p">:</span> <span class="o">...............................</span>
            <span class="p">}</span>
</code></pre></div>
</td></tr></table>
</li>
<li>
<p>On fournit également une fonction <code>conversion_vers_fichier</code> réciproque de la précédente qui convertit les valeurs de touts les attributs d'un enregistrement en type <code>str</code>, avant recopie de la table dans un fichier texte CSV. Compléter la fonction <code>main</code> ci-dessous, avec un code client permettant de réaliser l'objectif fixé en préambule de l'exercice.
Tester le code client pour vérifier les postconditions.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Code client&quot;&quot;&quot;</span>
    <span class="c1">#Traitement / validation / filtrage</span>
    <span class="n">table</span> <span class="o">=</span> <span class="n">lecture_csv</span><span class="p">(</span><span class="s1">&#39;clients_avec_erreurs.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">table_valide</span> <span class="o">=</span> <span class="p">[</span> <span class="o">.....................</span>
                    <span class="k">for</span> <span class="n">enregistrement</span> <span class="ow">in</span> <span class="n">table</span> <span class="k">if</span>     <span class="o">.................</span>        <span class="p">]</span>
    <span class="c1">#postconditions / tests</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">table</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1000</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">table_valide</span><span class="p">)</span> <span class="o">==</span> <span class="mi">719</span>
    <span class="k">assert</span> <span class="n">table_valide</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;nom&#39;</span><span class="p">:</span> <span class="s1">&#39;Bailly&#39;</span><span class="p">,</span> <span class="s1">&#39;prénom&#39;</span><span class="p">:</span> <span class="s1">&#39;Aurélie&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;abailly1@gmail.com&#39;</span><span class="p">,</span> <span class="s1">&#39;département&#39;</span><span class="p">:</span> <span class="s1">&#39;22&#39;</span><span class="p">,</span> <span class="s1">&#39;naissance&#39;</span><span class="p">:</span> <span class="s1">&#39;1986-09-22&#39;</span><span class="p">,</span> <span class="s1">&#39;visites&#39;</span><span class="p">:</span> <span class="mi">79</span><span class="p">,</span> <span class="s1">&#39;dépenses&#39;</span><span class="p">:</span> <span class="mf">4389.47</span><span class="p">}</span>
    <span class="n">table_valide_str</span> <span class="o">=</span> <span class="p">[</span><span class="n">conversion_vers_fichier</span><span class="p">(</span><span class="n">enregistrement</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">enregistrement</span> <span class="ow">in</span> <span class="n">table_valide</span><span class="p">]</span>
    <span class="c1">#écriture de la table validée</span>
    <span class="n">ecriture_csv</span><span class="p">(</span><span class="n">table_valide_str</span><span class="p">,</span> <span class="s1">&#39;clients_sans_erreurs.csv&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
</li>
</ol>
</div>
<div class="admonition tip">
<p class="admonition-title">Exercice 3</p>
<p><em>Questions type E3C</em> </p>
<ol>
<li>
<p>On considère l'extraction suivante d'une base de données des
départements français. Cette extraction a ensuite été sauvegardée dans
un fichier texte.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="s2">&quot;01&quot;</span><span class="p">,</span><span class="s2">&quot;Ain&quot;</span><span class="p">,</span><span class="s2">&quot;AIN&quot;</span><span class="p">,</span><span class="s2">&quot;ain&quot;</span><span class="p">,</span><span class="s2">&quot;A500&quot;</span>
<span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="s2">&quot;02&quot;</span><span class="p">,</span><span class="s2">&quot;Aisne&quot;</span><span class="p">,</span><span class="s2">&quot;AISNE&quot;</span><span class="p">,</span><span class="s2">&quot;aisne&quot;</span><span class="p">,</span><span class="s2">&quot;A250&quot;</span>
<span class="s2">&quot;3&quot;</span><span class="p">,</span><span class="s2">&quot;03&quot;</span><span class="p">,</span><span class="s2">&quot;Allier&quot;</span><span class="p">,</span><span class="s2">&quot;ALLIER&quot;</span><span class="p">,</span><span class="s2">&quot;allier&quot;</span><span class="p">,</span><span class="s2">&quot;A460&quot;</span>
<span class="s2">&quot;4&quot;</span><span class="p">,</span><span class="s2">&quot;04&quot;</span><span class="p">,</span><span class="s2">&quot;Alpes-de-Haute-Provence&quot;</span><span class="p">,</span><span class="s2">&quot;ALPES-DE-HAUTE-PROVENCE&quot;</span><span class="p">,</span><span class="s2">&quot;alpes-de-haute-provence&quot;</span><span class="p">,</span><span class="s2">&quot;A412316152&quot;</span>
<span class="s2">&quot;5&quot;</span><span class="p">,</span><span class="s2">&quot;05&quot;</span><span class="p">,</span><span class="s2">&quot;Hautes-Alpes&quot;</span><span class="p">,</span><span class="s2">&quot;HAUTES-ALPES&quot;</span><span class="p">,</span><span class="s2">&quot;hautes-alpes&quot;</span><span class="p">,</span><span class="s2">&quot;H32412&quot;</span>
</code></pre></div>
</td></tr></table>
<p>On considère le code suivant :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">csv</span>

<span class="n">f</span> <span class="o">=</span>  <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;departements.csv&#39;</span><span class="p">,</span> <span class="n">newline</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">lesLignes</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="k">for</span> <span class="n">uneLigne</span> <span class="ow">in</span> <span class="n">lesLignes</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">uneLigne</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
<p>Que va produire l'exécution de ce code ?</p>
<ul>
<li><strong>Réponse A :</strong>  L'affichage de la troisième colonne à savoir le nom du département
    avec une majuscule initiale<ul>
<li><strong>Réponse B :</strong> L'affichage de tout le contenu du fichier</li>
<li><strong>Réponse C :</strong> L'affichage du nombre total de départements figurant dans le fichier</li>
<li><strong>Réponse D :</strong> L'affichage de la quatrième colonne, à savoir le nom du département
tout en majuscules</li>
</ul>
</li>
</ul>
</li>
<li>
<p>On dispose du fichier <code>'info.csv'</code> donné ci-dessous :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>nom, prenom, naissance, deces
lovelace, ada, 1815, 1852
von neumann, john, 1903, 1957
turing, alan, 1912, 1954
mccarthy, john, 1927, 2011
floyd, robert, 1936, 2001
</code></pre></div>
</td></tr></table>
<p>Le programme ci-dessous nous permet de créer un tableau à partir de ce
    fichier.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;info.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">firstLine</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span> <span class="c1"># chargement de la ligne d&#39;entête</span>
<span class="n">tableau</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">]</span> <span class="c1"># chargement des données</span>
</code></pre></div>
</td></tr></table>
<p>Les index des lignes de ce tableau vont :</p>
<ul>
<li><strong>Réponse A :</strong>  de 0 à 3<ul>
<li><strong>Réponse B :</strong> de 1 à 4</li>
<li><strong>Réponse C :</strong>  de 0 à 4</li>
<li><strong>Réponse D :</strong> de 0 à 5</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Quelle expression Python permet d'accéder au numéro de téléphone de Tournesol, sachant que le répertoire a été défini par l'affectation suivante :</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">repertoire</span> <span class="o">=</span> <span class="p">[</span> <span class="p">{</span><span class="s1">&#39;nom&#39;</span><span class="p">:</span><span class="s1">&#39;Dupont&#39;</span><span class="p">,</span> <span class="s1">&#39;tel&#39;</span><span class="p">:</span><span class="s1">&#39;5234&#39;</span><span class="p">},</span>
            <span class="p">{</span><span class="s1">&#39;nom&#39;</span><span class="p">:</span><span class="s1">&#39;Tournesol&#39;</span><span class="p">,</span> <span class="s1">&#39;tel&#39;</span><span class="p">:</span><span class="s1">&#39;5248&#39;</span><span class="p">},</span> 
            <span class="p">{</span><span class="s1">&#39;nom&#39;</span><span class="p">:</span><span class="s1">&#39;Dupond&#39;</span><span class="p">,</span><span class="s1">&#39;tel&#39;</span><span class="p">:</span><span class="s1">&#39;3452&#39;</span><span class="p">}]</span>
</code></pre></div>
</td></tr></table>
<ul>
<li><strong>Réponse A :</strong>  <code>repertoire['Tournesol']</code><ul>
<li><strong>Réponse B :</strong>  <code>repertoire['tel'][1]</code></li>
<li><strong>Réponse C :</strong>  <code>repertoire[1]['tel']</code></li>
<li><strong>Réponse D :</strong>   <code>repertoire['Tournesol'][tel]</code></li>
</ul>
</li>
</ul>
</li>
</ol>
</div>
<h1 id="synthese">Synthèse<a class="headerlink" href="#synthese" title="Permanent link">⚓︎</a></h1>
<div class="admonition abstract">
<p class="admonition-title">Synthèse </p>
<p>Les <strong>tables de données</strong> sont très courantes : les données sont organisées en <strong>enregistrements</strong> (ligne du tableau) qui sont des <strong>p-uplets nommés</strong> partageant les mêmes <strong>attributs</strong> (entêtes de colonnes dans un tableau).</p>
<p>Les  <strong>tables de données</strong> sont souvent stockées sous forme de fichiers <a href="https://fr.wikipedia.org/wiki/Comma-separated_values">CSV</a> : ce sont des fichiers textes où les  enregistrements sont des lignes dont les attributs sont séparés par un caractère <strong>délimiteur</strong>. </p>
<p>En Python, une table contenue dans  un fichier  <a href="https://fr.wikipedia.org/wiki/Comma-separated_values">CSV</a> peut être représentée dans un <strong>tableau de tableaux</strong> ou plutôt un <strong>tableau de dictionnaires</strong>. Le <a href="https://docs.python.org/fr/3/library/csv.html">module csv</a> facilite les opérations d'importation et d'exportation de tables vers des fichiers <a href="https://fr.wikipedia.org/wiki/Comma-separated_values">CSV</a>.</p>
</div>
<figure>
<img src="images/file_extensions.png" style="width:40.0%" alt="XKCD 1301" /><figcaption aria-hidden="true"><a href="https://www.explainxkcd.com/wiki/index.php/1301:_File_Extensions">XKCD 1301</a></figcaption>
</figure>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../automatismes/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Précédent
              </span>
              Page 1
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            (CC BY-NC-SA 4.0)
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
      <a href="mailto:admin@frederic-junier.org" target="_blank" rel="noopener" title="Frédéric Junier" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M476 3.2 12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tabs", "navigation.expand", "navigation.top", "toc.integrate", "header.autohide"], "translations": {"clipboard.copy": "Copier dans le presse-papier", "clipboard.copied": "Copi\u00e9 dans le presse-papier", "search.config.lang": "fr", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Rechercher", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.7353b375.min.js"></script>
      
        <script src="../../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>